//https://github.com/SteveBeeblebrox/SHML/blob/main/LICENSE
"use strict";var SHML;!function(t){function e(t,e=0){let r=3735928559^e,n=1103547991^e;for(let e,i=0;i<t.length;i++)e=t.charCodeAt(i),r=Math.imul(r^e,2654435761),n=Math.imul(n^e,1597334677);return r=Math.imul(r^r>>>16,2246822507)^Math.imul(n^n>>>13,3266489909),((n=Math.imul(n^n>>>16,2246822507)^Math.imul(r^r>>>13,3266489909))>>>0).toString(16).padStart(8,"0")+(r>>>0).toString(16).padStart(8,"0")}let r,n;function i(t,n){if(r.isInvalid(t))throw"Invalid Unicode Noncharacters present in text";t=t.replace(/[<>&"']/g,t=>{switch(t){case"<":return"&lt;";case">":return"&gt;";case"&":return"&amp;";case'"':return"&quot;";case"'":return"&#x27;";default:throw null}});const i=new Map;return function(t){for(;t.includes(r.INLINE_MARKER)||t.includes(r.BLOCK_MARKER);)t=t.replace(/([\ufffe\uffff]).*?\1/,t=>{var e;const r=i.get(t);return(null!==(e=n.get(r.blockType).reviver)&&void 0!==e?e:({blockType:t,groups:e})=>`<${t}>${e.TEXT}</${t}>`)(r)});return t}(function t(n,s){for(const[a,{pattern:o,isInline:l}]of s.entries())n=n.replace(o,(...n)=>{const o=n[0],u=n[n.length-1],c="object"==typeof u?u:void 0,p=(null==l||l)&&r.INLINE_MARKER||r.BLOCK_MARKER,g=`${p}${e(o).split("").map(t=>r.HEXADECIMAL_MAPPING[t]).join("")}${p}`;for(const[e,r]of Object.entries(null!=c?c:{}))e.toUpperCase()===e&&(c[e]=t(r,new Map([...s.entries()].filter(([t])=>t!==a))));return i.set(g,{blockType:a,text:o,groups:c}),g});return n}(t,n))}t.VERSION="1.3.5",function(t){const e=t=>{throw t};t.NONCHARACTERS=Object.freeze([...function*(){for(let t=0;t<16;t++)yield 65534+65536*t,yield 65535+65536*t;yield 1114110,yield 1114110;for(let t=64976;t<65008;t++)yield t}()].map(t=>String.fromCodePoint(t)));const r=function*(){for(const e of t.NONCHARACTERS)yield e}();function n(){var t;return null!==(t=r.next().value)&&void 0!==t?t:e("No more noncharacters")}t.nextNoncharacter=n,t.isInvalid=function(e){return new RegExp(`[${t.NONCHARACTERS.join("")}]`).test(e)},t.INLINE_MARKER=n(),t.BLOCK_MARKER=n(),t.HEXADECIMAL_MAPPING=Object.fromEntries(Array.apply(null,{length:16}).map((t,e)=>[e.toString(16),n()]))}(r||(r={})),function(t){function r(e=new Map){const r=new Map;function n(t){return new RegExp(String.raw`(${t.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")})(?<TEXT>.*?)\1`,"g")}return r.set("escaped",{pattern:/\\(?<what>[^ntp])/g,reviver:({groups:t})=>t.what}),r.set("raw",{pattern:/&lt;&lt;\/(?<text>[\s\S]*?)\/&gt;&gt;/g,reviver:({groups:t})=>t.text}),r.set("src_comment",{pattern:/&lt;!!--(?<text>[\s\S]*?)--&gt;/g,reviver:()=>""}),r.set("comment",{pattern:/&lt;!--(?<text>[\s\S]*?)--&gt;/g,isInline:!0,reviver:({groups:t})=>`\x3c!--${t.text}--\x3e`}),r.set("code",{pattern:/(`)(?<text>.*?)\1/g,reviver:({groups:t})=>`<code>${t.text}</code>`}),r.set("symbol",{pattern:/\/(?<what>(&#x27;|&quot;|.).|\?|!)\//g,reviver({groups:e}){var r,n;switch(e.what){case"!":return"&iexcl;";case"?":return"&iquest;";default:return null!==(n=null===(r=t.SYMBOLS[e.what.substring(0,e.what.length-1)])||void 0===r?void 0:r[e.what.substring(e.what.length-1)])&&void 0!==n?n:`/${e.what}/`}}}),r.set("unicode_shortcut",{pattern:/(?<=\b)(?:TM|SS)(?=\b)|\([cCrR]\)|-&gt;|&lt;-/g,reviver({text:t}){switch(t){case"SS":return"&section;";case"PG":return"&para;";case"TM":return"&trade;";case"(C)":case"(c)":return"&copy";case"(R)":case"(r)":return"&reg;";case"-&gt;":return"&rarr;";case"&lt;-":return"&larr;";default:return t}}}),r.set("strong",{pattern:/(\*\*)(?=[^*])(?<TEXT>.*?)\1/g}),r.set("em",{pattern:/(\*)(?=[^*])(?<TEXT>.*?)\1/g}),r.set("u",{pattern:n("__")}),r.set("del",{pattern:n("~~")}),r.set("sup",{pattern:n("^^")}),r.set("sub",{pattern:n(",,")}),r.set("mark",{pattern:/(\|\|)(\[(?:color=)?(?<color>[^;]*?)\])?(?<TEXT>.*?)\1/g,reviver:({groups:t})=>`<mark${t.color?` style="color:${t.color}"`:""}>${t.TEXT}</mark>`}),r.set("span",{pattern:/(&amp;&amp;)(\[(?:color=)?(?<color>[^;]*?)\])?(?<TEXT>.*?)\1/g,reviver({groups:t}){var e;return`<span style="color:${null!==(e=t.color)&&void 0!==e?e:"red"}">${t.TEXT}</span>`}}),r.set("spoiler",{pattern:/&lt;\?(?<TEXT>.*?)\?&gt;/g,reviver:({groups:t})=>`<span style="filter: blur(0.25em); cursor: pointer;" title="Show spoiler?" onclick="this.removeAttribute('style'); this.removeAttribute('title'); this.removeAttribute('onclick');">${t.TEXT}</span>`}),r.set("custom_token",{pattern:/:(?<what>[a-zA-Z0-9][a-zA-Z0-9_\-]*?):/g,isInline:!0,reviver({groups:t}){var r;return null!==(r=e.get(t.what))&&void 0!==r?r:`:${t.what}:`}}),r.set("nbsp",{pattern:/\\p/g,reviver:()=>"&nbsp;"}),r.set("emsp",{pattern:/\\t/g,reviver:()=>"&emsp;"}),r.set("linebreak",{pattern:/\\n/g,reviver:()=>"<br>"}),r.set("wordbreak",{pattern:/(?<=\S)-\/-(?=\S)/g,reviver:()=>"<wbr>"}),r.set("a",{pattern:/(?<newtab>\+)?\[(?<href>.*?)\]\((?<TEXT>.*?)\)/g,isInline:!0,reviver:({blockType:t,text:e,groups:r})=>`<a href="${/^[^:]*?(?:(?:(?<=mailto|tel|https|http):|\/.*:).*)?$/g.test(r.href)?r.href:"about:blank#blocked"}"${r.newtab?' target="_blank"':""}>${r.TEXT}</a>`}),r.set("autolink",{pattern:/(?<text>(?:(?<protocol>https?:\/\/)|(?<www>www\.))(?<link>\w[\w\-]*(?<=\w)\.\w[\w.\/?&#%=+\-]*(?<=[\w\/])))/g,reviver({groups:t}){var e,r;return`<a href="${null!==(e=t.protocol)&&void 0!==e?e:"https://"}${null!==(r=t.www)&&void 0!==r?r:""}${t.link}">${t.text}</a>`}}),r.set("autolink_email",{pattern:/(?<text>\w[\w.\-]*?@[\w.\-]+\.\w+)/g,reviver:({groups:t})=>`<a href="mailto:${t.text}">${t.text}</a>`}),r.set("html",{pattern:/&lt;(?<what>\/?(?:code|em|i|strong|b|u|del|sub|sup|mark|span|wbr|br))&gt;/g,isInline:!0,reviver:({blockType:t,text:e,groups:r})=>`<${r.what}>`}),r}t.SYMBOLS={"~":{A:"Ã",I:"Ĩ",N:"Ñ",O:"Õ",U:"Ũ",a:"ã",i:"ĩ",n:"ñ",o:"õ",u:"ũ"},":":{A:"Ä",E:"Ë",I:"Ï",O:"Ö",U:"Ü",Y:"Ÿ",a:"ä",e:"ë",i:"ï",o:"ö",u:"ü",y:"ÿ"},"&#x27;":{A:"Á",C:"Ć",E:"É",I:"Í",L:"Ĺ",N:"Ń",O:"Ó",R:"Ŕ",S:"Ś",U:"Ú",Y:"Ý",Z:"Ź",a:"á",c:"ć",e:"é",g:"ǵ",i:"í",l:"ĺ",n:"ń",o:"ó",r:"ŕ",s:"ś",u:"ú",y:"ý",z:"ź"},"&quot;":{O:"Ő",U:"Ű",o:"ő",u:"ű"},"`":{A:"À",E:"È",I:"Ì",O:"Ò",U:"Ù",a:"à",e:"è",i:"ì",o:"ò",u:"ù"},"^":{A:"Â",C:"Ĉ",E:"Ê",G:"Ĝ",H:"Ĥ",I:"Î",J:"Ĵ",O:"Ô",S:"Ŝ",U:"Û",W:"Ŵ",Y:"Ŷ",a:"â",c:"ĉ",e:"ê",g:"ĝ",h:"ĥ",i:"î",j:"ĵ",o:"ô",s:"ŝ",u:"û",w:"ŵ",x:"◯",y:"ŷ"},o:{A:"Å",U:"Ů",a:"å",u:"ů"},"/":{O:"Ø",h:"ℏ",o:"ø"},",":{C:"Ç",G:"Ģ",K:"Ķ",L:"Ļ",N:"Ņ",R:"Ŗ",S:"Ş",T:"Ţ",c:"ç",k:"ķ",l:"ļ",n:"ņ",r:"ŗ",s:"ş",t:"ţ"},"-":{A:"Ā",E:"Ē",I:"Ī",O:"Ō",U:"Ū",a:"ā",e:"ē",i:"ī",o:"ō",u:"ū"},u:{A:"Ă",G:"Ğ",U:"Ŭ",a:"ă",g:"ğ",u:"ŭ"},".":{C:"Ċ",E:"Ė",G:"Ġ",I:"İ",Z:"Ż",c:"ċ",e:"ė",g:"ġ",o:"⊙",s:"⋅",t:"⃛",z:"ż"},"?":{A:"Ą",E:"Ę",I:"Į",U:"Ų",a:"ą",e:"ę",i:"į",u:"ų"},v:{C:"Č",D:"Ď",E:"Ě",L:"Ľ",N:"Ň",R:"Ř",S:"Š",T:"Ť",Z:"Ž",c:"č",d:"ď",e:"ě",l:"ľ",n:"ň",r:"ř",s:"š",t:"ť",z:"ž"},_:{D:"Đ",H:"Ħ",L:"Ł",T:"Ŧ",d:"đ",h:"ħ",l:"ł",t:"ŧ"}},t.inline=r,t.block=function(t=new Map,n=new Map,i=new Set){const s=new Map,a=r(t);s.set("escaped",a.get("escaped")),s.set("raw",a.get("raw")),s.set("src_comment",a.get("src_comment")),s.set("comment",a.get("comment")),s.set("code_block",{pattern:/(```)(?<text>[\s\S]*?)\1/g,isInline:!1,reviver:({groups:t})=>`<pre><code>${t.text}</code></pre>`}),s.set("property",{pattern:/^\s*?(?<key>[a-zA-Z_][a-zA-Z_0-9]*?)(?<!http|https):(?<value>.*?)(?=\n)/gm,isInline:!1,reviver:({groups:t})=>(n.set(t.key,t.value.trim()),"")}),s.set("template",{pattern:/\${(?<key>[a-zA-Z_][a-zA-Z_0-9]*?)\}/g,isInline:!0,reviver({groups:t}){var e;return null!==(e=n.get(t.key))&&void 0!==e?e:`\${${t.key}}`}}),s.set("image",{pattern:/!\[(?<src>\S*?)(?:\s*?(?<height>auto|\d*)(?:[xX](?<width>auto|\d*))?)?\](?:\((?<alt>.*?)\))?/g,reviver({groups:t}){var e;return null!==(e=t.width)&&void 0!==e||(t.width=t.height),`<img src="${t.src}"${t.alt?` alt="${t.alt}"`:""}${t.height?` height="${t.height}"`:""}${t.width?` width="${t.width}"`:""}>`}});for(const t of a.entries())s.has(t[0])||s.set(...t);return s.set("text-align",{pattern:/(?<=\n|^)[^\S\n]*?@@\s*?(?<what>center(?:ed)?|left|right|justif(?:y|ied)(?:-all)?)\s*?(?<TEXT>[\s\S]*?)(?:$|(?:(?<=\n)[^\S\n]*?@@\s*?reset)|(?=\n[^\S\n]*?@@\s*?(?:center(?:ed)?|left|right|justif(?:y|ied)(?:-all)?)))/g,isInline:!1,reviver({groups:t}){var e;return`<div style="text-align: ${null!==(e={centered:"center",justified:"justify","justified-all":"justify-all"}[t.what])&&void 0!==e?e:t.what};">${t.TEXT}</div>`}}),s.set("numbered_header",{pattern:/^\s*?(?<count>#{1,6})(?:\[(?<id>[a-zA-Z_][a-zA-Z_0-9]*?)\])?\s?(?<TEXT>[^\uffff]*?)\k<count>?(?=\n|$)/gm,isInline:!1,reviver({groups:t}){var r;return t.id&&i.add(`h${t.count.length}:${t.id}`),null!==(r=t.id)&&void 0!==r||(t.id=e(t.TEXT)),`<h${t.count.length} id="h${t.count.length}:${t.id}"><a href="#h${t.count.length}:${t.id}" title="Link to section">${t.TEXT}</a></h${t.count.length}>`}}),s.set("hr",{pattern:/^\s*([-=])\1{2,}\s*$/gm,isInline:!1,reviver:()=>"<hr>"}),s.set("table",{pattern:/\[\[(?:\n\s*(?:title=)?(?<title>[^,\n]*)\n)?(?<contents>[\s\S]*?)\]\]/g,isInline:!1,reviver({groups:t}){const e=t.contents.trim().split("\n").map((t,e)=>`\n<tr>${t.split(",").map(t=>`<t${e?"d":"h"}>${t.trim()}</t${e?"d":"h"}>`).join("")}</tr>`);return`<table>${t.title?`\n<caption>${t.title.trim()}</caption>`:""}\n<thead>${e.shift()}\n<thead>\n<tbody>${e.join("")}\n<tbody>\n</table>`}}),s.set("bull",{pattern:/(?<text>(?:\+.*?(?:\n|$))+)/g,isInline:!1,reviver:({groups:t})=>`<ul>\n${t.text.split("\n").filter(t=>t.trim()).map(t=>`<li>${t.replace(/^\s*?\+\s*/,"")}</li>`).join("\n")}\n</ul>`}),s.set("list",{pattern:/(?<text>(?:\d+[).].*?(?:\n|$))+)/g,isInline:!1,reviver:({groups:t})=>`<ol>\n${t.text.split("\n").filter(t=>t.trim()).map(t=>`<li>${t.replace(/^\s*?\d+[).]\s*/,"")}</li>`).join("\n")}\n</ol>`}),s.set("blockquote",{pattern:/(?<text>(?:(?:&gt;){3}[\s\S]*?(?:-\s*?(?<citation>.*?))?(?:\n|$))+)/g,isInline:!1,reviver({groups:t}){var e;return`<figure><blockquote>${t.text.replace(/(?:&gt;){3}/g,"").replace(new RegExp(String.raw`-\s*?${null===(e=t.citation)||void 0===e?void 0:e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}\s*?$`),"")}</blockquote>${t.citation&&`<figcaption><cite>- ${t.citation}</cite></figcaption>`||""}</figure>`}}),s.set("block_html",{pattern:/&lt;(?<what>\/?(?:h[123456]|hr|blockquote|ul|ol|li))&gt;/g,isInline:!1,reviver:({groups:t})=>`<${t.what}>`}),s.set("text",{pattern:/(?<=\n)\n?(?<TEXT>[^\uffff]+?)(?=  \s*?\n|\n\n|\uffff|$)/g,isInline:!1,reviver:({blockType:t,text:e,groups:r})=>r.TEXT.trim()?`<p>${r.TEXT.trim()}</p>\n`:""}),s}}(n||(n={})),t.parseInlineMarkup=function(t,e){return i(t,n.inline(e))},t.parseMarkup=function(t,e,r){var s;const a=new Map(null!==(s=null==r?void 0:r.entries())&&void 0!==s?s:[]),o=new Set,l=new String(i(t,n.block(e,a,o)));return Object.defineProperty(l,"properties",{value:a}),Object.defineProperty(l,"ids",{value:o}),l}}(SHML||(SHML={}));
